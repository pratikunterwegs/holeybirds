---
output: html_document
editor_options: 
  chunk_output_type: console
---
# Try residence patch method

## Load libraries and prepare files

```{r}
# libs for data
library(data.table)
library(lubridate)

# library for atlas data
library(atlastools)

# plotting
library(ggplot2)
library(ggspatial)
library(colorspace)
```

```{r}
# load data from file
data <- fread("data/processed/data_for_analysis.csv")
```

### Prepare data

```{r}
df = data[TAG_ID == "1004001748", c("x", "y", "time", "TAG_ID")]
setnames(df, old = "TAG_ID", "id")

# get speeds and angles
df[, c("speed", "angle") := list(
    atl_get_speed(df),
    atl_turning_angle(df)
)]

# fill NAs and NANs
df$angle = nafill(df$angle, fill = 0)
```

### Plot speed

```{r}
ggplot(df)+
    geom_path(
        aes(x, y),
        col = "grey20",
        size = 0.1
    )+
    geom_point(
        aes(x,y,col=speed)
    )+
    scale_colour_binned_sequential(
        palette = "Viridis",
        breaks = c(0, 0.5, 1)
    )
```
